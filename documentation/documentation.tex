\documentclass{article}
\usepackage[british]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{float}
\usepackage{floatflt}
\usepackage{hyperref}
\usepackage{listings}
\usepackage[dvipsnames]{xcolor}
\usepackage{lineno}
\usepackage{appendix}
\usepackage{gensymb}

\lstdefinelanguage{JavaScript}{
	keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
	keywordstyle=\color{blue}\bfseries,
	ndkeywords={class, export, boolean, throw, implements, import, this},
	ndkeywordstyle=\color{darkgray}\bfseries,
	identifierstyle=\color{black},
	sensitive=false,
	comment=[l]{//},
	morecomment=[s]{/*}{*/},
	commentstyle=\color{purple}\ttfamily,
	stringstyle=\color{red}\ttfamily,
	morestring=[b]',
	morestring=[b]"
}

\lstset{
	language=JavaScript,
	backgroundcolor=\color{lightgray},
	extendedchars=true,
	basicstyle=\footnotesize\ttfamily,
	showstringspaces=false,
	showspaces=false,
	numbers=left,
	numberstyle=\footnotesize,
	numbersep=9pt,
	tabsize=2,
	breaklines=true,
	showtabs=false,
	captionpos=b
}

\begin{document}
\title{\textbf{Interactive Graphics - Final Project}
		\\ \medskip \textbf{Solar System}
		\\ \medskip \large A.Y. 2018/2019 }
\date{\today}
\author{Gianmarco Cariggi 1698481 \\ \medskip Marco Costa 1691388}
\maketitle


\section{Introduction}
For the final project of the course of Interactive Graphics we decided to make a simulator of our solar system, trying to reproduce it in the most faithful and realistic way possible, using of course assumptions and approximations to simplify its implementation.

\subsection{Requirements}
\begin{itemize}
	\item Hierarchical models
	\item Lights
	\item Textures
	\item User interaction
	\item Animation
\end{itemize}

\subsection{Environment}
The project is developed in WebGL (Web Graphics Library). It's a JavaScript API for rendering interactive 2D and 3D graphics within any compatible web browser without the use of plug-ins. It is fully integrated with other web standards, allowing GPU-accelerated usage of physics and image processing and effects as part of the web page canvas.
\newline
Click \href{https://get.webgl.org/}{here} to check if your browser supports WebGL.

\subsection{Libraries not developed by the team}
\begin{itemize}
	\item \href{https://threejs.org/}{\textbf{Three Js} (rev. 107dev)}: a cross-browser JavaScript library and Application Programming Interface (API) used to create and display animated 3D computer graphics in a web browser using \textit{WebGL}.
	\item \href{https://materializecss.com/}{\textbf{Materialize} (v. 1.0.0)}: a design language that combines the classic principles of successful design along with innovation and technology.
	\item \href{https://jquery.com/}{\textbf{jQuery} (v. 3.4.1)}: it takes a lot of common tasks that require many lines of JavaScript code to accomplish, and wraps them into methods that you can call with a single line of code. It also simplifies a lot of the complicated things from \textit{JavaScript}, like \textit{AJAX} calls and \textit{DOM} manipulation.
\end{itemize}

\subsection{Assumptions and approximations}
As is well known, the planets follow an elliptical orbit (a "flattened" circumference), and the sun occupies one of the two focuses. Rotating along this orbit, we have the 4 seasons (also due to the inclination of the axis). For simplicity of implementation and positioning of the various planets, we have approximated the orbit with a circumference, and the sun occupies  centre. \newline
\par Another important fact is that the orbit of all the planets varies continuously (for example, the orbit of the earth is not the same from one year to the next), this is because there is the gravitational influence of all the celestial bodies present in the universe (and in particular in the solar system, being closer). In the solar system, besides the sun, Jupiter has an important influence, being the biggest planet. In our simulator we do not take into account all this, the planets revolve around the sun with the same orbit (we can say that the sun is the only body that influences the gravitation of the planets). \newline
\par The last detail is the actual position of the planets. Probably they will not be located in the real position, because in our simulator this position depends on the date, and in JavaScript the function \textbf{Date.getTime()} returns the milliseconds passed from January 1, 1970 to the moment in which the function is called. In theory we should have the milliseconds passed from the birth of the solar system to today, or set a certain initial position so as to match the real position of each planet with that in the simulator. But this is very complex, so we preferred to concentrate on other things. It must be noted however that every planet makes a turn around the sun in the real time of revolution and makes a turn around its axis (inclined with respect to the equatorial plane) in the real time of rotation (for example the earth takes exactly one year to make the revolution around the sun and 24 hours to make a turn on itself).\cite{solarsystemrealpositon}\cite{earthcloudsradiustexture}


\section{Usage}
The graphic interface allows to client to interact with our projects. First of all there is a fast loader page meanwhile the browser loads all the data.\par
At the beginning camera is focused on Sun and the \textit{follow-planet} flag is enabled, then you can only move camera around the sun. In order to move in the solar system, you have to disable it through the main menu.\newline
In meanwhile a background music starts in order to create a pleasant atmosphere and to take a good travel around the solar system. If you don't like it, you can disable through the specific button at bottom right of the window.\newline
Since you disable the \textit{follow-planet}, now you can move.\newline
\textbf{Have a good trip!}

\subsection{Mouse Controls}
The mouse is very important to fully enjoy this experience, so we explain the  available mouse controls below:
\begin{itemize}
	\item \textbf{Left Click}: Normally you click button or elements in the menu. If menu is opened and click on the solar system, it will close. If you click and drag the camera orbits around the target point.
	\item \textbf{Double Left Click}: If it's done over a celestial objects (except \textit{Asteroid Belt}), it permits to select and focus the camera on it.
	\item \textbf{Right Click}: If the \textit{follow-planet} flag is disabled, you can move around the environment clicking and dragging.
	\item \textbf{Scroll Wheel}: As usual, the scroll wheel permits to zoom in or zoom out on camera's target.
	\item \textbf{Move on the object}: Moving over the planets, a pop-up window appears where there are all planet's physical data.
\end{itemize}
All the commands are possible through the using of \textit{OrbitControls} of \textit{Three JS}.

\subsection{Menu Options}
The menu offers to you a lot of options to custom the animation and the aspect of solar system. It can be opened or closed simply clicking on the relative button in the top right of the screen. So let to describe all the options:
\begin{itemize}
	\item \textbf{Play / Pause Animation}: Play or pause all animations of the solar system. (Default: Play)
	\item \textbf{Rotation}: Play or pause only the rotation on the axis of planet. (Default: Play)
	\item \textbf{Revolution}: Play or pause only the revolution orbit. (Default: Play)
	\item \textbf{Trajectories}: Show / Hide the orbit trajectories. (Default: ON)
	\item \textbf{Inclined orbit}: Set / Unset the real inclination of the planet's orbit. (Default: ON)
	\item \textbf{Date}: Set a specific date to see the state of solar. system. 
	\item \textbf{Time}: Set a specific time to see the state of solar system.
	\item \textbf{Speed}: Set the speed of time flowing (and then the animation). (Default: 1.0x)
	\item \textbf{Far}: Set the far parameter of camera. (Default: 10000).
	\item \textbf{Camera}: Set the camera target planet (as double click on a planet). (Default: Sun)
	\item \textbf{Follow}: Camera follows or not the target planet. (Default: ON)
	\item \textbf{Rotate Camera}: Camera orbits around the target planet. (Default: OFF)
	\item \textbf{Earth clouds}: Show / Hide the Earth's clouds. (Default: OFF)
	\item \textbf{Asteroid Belt}: Show / Hide the asteroid belt. (Default: OFF)
	\item \textbf{Ambient light}: Turn on / off the ambient light. (Default: OFF)
	\item \textbf{Sun light}: Turn on / off the Sun light. (Default: ON)
	\item \textbf{Sun glow}: Turn on / off the Sun glow. (Default: ON)
	\item \textbf{Sun light intensity}: Set the sun light intensity (Default: 1.5)
	\item \textbf{Wallpaper}: Choose the background.
	\item \textbf{Track}: Choose the background music.
	\item \textbf{Volume}: Set the volume of track. (Default: 0.3)
\end{itemize}

\newpage
\section{Implementation}
In this section, let we how we implemented all the features in the project. We prefer to divide this section in subsection to make easier the lecture and understanding.

\subsection{Three JS basic components}
The first part is about the initialization of Three JS, in this case we create the scene and the other fundamental elements for a WebGL environment. We do this in the \textit{init} function.
\subsubsection{Scene}
The first element for Three JS environment is the \textit{scene}\cite{documentation:threejs}. It is rendered and be simply instantiate using:
\begin{lstlisting}
scene = new THREE.Scene();
\end{lstlisting}
\subsubsection{Camera and OrbitControls}
The second step is the camera, it allows to watch the scene. In our case, we use a perspective camera, with a \textit{FOV} = 45\degree, \textit{near} = 0.1 and an adapting \textit{far} to make visible the far objects\cite{documentation:threejs}.
\par Beside the camera, we use OrbitControls library that allows mouse interactions with the camera. The parameter passed to the function specify which area of the canvas is under control of \textit{OrbitControls}. We choose the container, in this way, when the menu is opened, menu area is ignored by the controller\cite{documentation:threejs}.
\begin{lstlisting}
camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, far);
camera.position.y = 45;
camera.position.z = 100;
camera.lookAt(new THREE.Vector3(0, 0, 0));
controls = new THREE.OrbitControls(camera, document.getElementById("container"));
controls.autoRotateSpeed = 1;
\end{lstlisting}
\subsubsection{Raycaster}
Raycaster is very important in our project, because we have to establish which object is "captured" by the mouse cursor for different goals as we explain later\cite{documentation:threejs}. It's sufficient an instruction:
\begin{lstlisting}
raycaster = new THREE.Raycaster();
\end{lstlisting}
\subsubsection{Renderer}
We use the standard \textit{WebGLRenderer}\cite{documentation:threejs}, enabling the antialiasing filter and using Percentage-Closer Soft Shadows (PCSS) as shadow maps filter\cite{PCSS:nvidia}.
\begin{lstlisting}
renderer = new THREE.WebGLRenderer({
antialias: true
});
renderer.setSize(window.innerWidth, window.innerHeight);
document.getElementById("container").appendChild(renderer.domElement);
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;
\end{lstlisting}
\subsubsection{Texture Loader}
Texture loader\cite{documentation:threejs} is used to load all textures to relative objects.
\begin{lstlisting}
textureLoader = new THREE.TextureLoader();
\end{lstlisting}

\subsection{Light}

\subsection{Music}

\subsection{Models}

\subsection{Animation}

\subsection{Client Interactions}

\subsection{HTML and CSS}


\begin{thebibliography}{99}
\bibitem{solarsystemrealpositon} \href{https://theskylive.com/3dsolarsystem}{Verify} the real-time position of solar system objects.
\bibitem{planetpixelemporium} \href{http://planetpixelemporium.com/planets.html}{Planet pixel emporium}, website for planet textures.
\bibitem{wikipedia} \href{https://www.wikipedia.org/}{Wikipedia} - for data and descriptions of the celestial objects.
\bibitem{earthcloudsradiustexture} \href{https://github.com/jeromeetienne/threex.planets/blob/master/threex.planets.js}{Threex.planets.js} - for loading earth clouds texture and have a ring geometry with a radius texture.
\bibitem{documentation:threejs} ThreeJS documentation: \href{https://threejs.org/docs/#api/en/scenes/Scene}{Scene}
\href{https://threejs.org/docs/#api/en/cameras/PerspectiveCamera}{Perspective Camera}  \href{https://threejs.org/docs/#examples/en/controls/OrbitControls}{OrbitControls} \href{https://threejs.org/docs/#api/en/core/Raycaster}{Raycaster} \href{https://threejs.org/docs/#api/en/renderers/WebGLRenderer}{WebGLRenderer}.
\href{https://threejs.org/docs/#api/en/loaders/TextureLoader}{Texture Loader}
\bibitem{PCSS:nvidia} \href{http://developer.download.nvidia.com/shaderlibrary/docs/shadow_PCSS.pdf}{Percentage-Closer Soft Shadows}, Randima Fernando, NVIDIA Corporation.
\end{thebibliography}


\appendix
\appendixpage
\addappheadtotoc
\section{Sources}
\begin{itemize}
	\item 
	
\end{itemize}

\end{document}